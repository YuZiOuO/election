/*! updated; 11-06-2020 01:18 AM **/


Modulr.define("fox-news.elections.feeds.2020:api",["require","jquery","lodash","helper","akamai","jquery.numLiveUpdate","router","core.plugins:CountdownTimer","core.plugins:DateTime","api.presidential"],function(require,$,_,Helper){function Model(config){var Proto=this,type=config.type,typeId=config.typeId,Router=new RouterInstance(type),FEED_API=Router.getAPI(typeId,config.opts||null),TIMER_INIT=!1,CURRENT_TIMER=!1,EVENTS_STACK=[];function setTimerInstance(){return new CountdownTimer({endTime:function(time){return time.setSeconds(time.getSeconds()+60*CONST.refresh),time}(AkamaiTime.getCurrent()),maxTime:"hours"})}function setEventsTimer(){CURRENT_TIMER&&CURRENT_TIMER.stopCountdowns(),CURRENT_TIMER=setTimerInstance();function trigger(events){events&&"function"==typeof events.onReload&&events.onReload(),CURRENT_TIMER.onTick(function(info){events&&"function"==typeof events.onTick&&events.onTick(info,CONST.refresh)}),CURRENT_TIMER.onDone(function(){events&&"function"==typeof events&&events.onDone(),Proto.reload()})}for(var i=0;i<EVENTS_STACK.length;i++)trigger(EVENTS_STACK[i])}Proto._prop={type:type,typeId:typeId},Proto.API=FEED_API,Proto.dataEnabled=function(opts,callback){var fips=null;"string"==typeof opts?fips=opts:(fips=opts.fips,opts.party),Helper.feedTestOverride()?callback(!Helper.noFeedOverride()):Helper.noFeedOverride()||FEED_API.admin.getData(function(Feed){Proto.dataRealtime(fips,function(active){callback(!!active)})})},Proto.electionsToday=function(){var args=arguments,code=null,callback=null;if("function"==typeof args[0]?callback=args[0]:"function"==typeof args[1]&&(callback=args[1],code=args[0]),!callback)return!1;FEED_API.admin.getData(function(Feed){var val=!code||-1<$.inArray(code,!0);callback(val)})},Proto.isSueprTuesday=function(){var current=AkamaiTime.getCurrent();return-1<DateTime(current,"${mm}/${dd}/${yr}").indexOf("3/03/2020")||-1<window.location.search.indexOf("_super=1")},Proto.dataRealtime=function(fips,callback){FEED_API.admin.getData(function(Feed){callback(!0)})},Proto.reload=function(){var refreshSecs=60*CONST.refresh;if(CURRENT_TIMER){var info=CURRENT_TIMER.getInfo();if(Math.floor(info.raw_ms/1e3)<refreshSecs-5){var currStr=DateTime(AkamaiTime.getCurrent(),"${hr:mil}:${min}:${sec}");log("[Feed] RELOADING... ["+currStr+"]"),Router.reload(),setEventsTimer()}}},Proto.setTimer=function(events){TIMER_INIT?EVENTS_STACK.push(events):(TIMER_INIT=!0,EVENTS_STACK.push(events),setEventsTimer())},Proto.numUpdate=function(target,val,opts){function fmt(n,raw){var nval=raw?n:Math.floor(n);return formatStr.replace("${num}",Helper.dataDisplayStr(opts.format||"num",nval))}var ceil,floor,hi=(opts=opts||{}).intervalHi||35,low=opts.intervalLow||20,duration=opts.duration||5e3,precision=opts.precision||!1,formatStr=opts.formatStr||"${num}",intVal=(ceil=hi,floor=low,Math.floor(Math.floor(Math.random()*(ceil-floor)+1)+floor));if(precision)target.html(fmt(val,!0));else if(opts.initial){var startVal=function(val){return val=(val=val.replace(/[^0-9]/g,""))&&!isNaN(val)?parseInt(val,10):0}(target.text());$.numLiveUpdate({val:val,start:startVal,duration:duration,interval:intVal,format:function(n){return Math.floor(n)}},function(n){target.html(fmt(n))})}else target.numLiveUpdate({val:val,duration:duration,interval:intVal,format:function(n){return fmt(n)}})}}var RouterInstance=require("router"),AkamaiTime=require("akamai").time,DateTime=require("core.plugins:DateTime"),CountdownTimer=require("core.plugins:CountdownTimer"),PresidentialFeedAPI=require("api.presidential"),log=Helper.log,CONST={refresh:Helper.feedTestOverride()?.5:1};return function(config){return(config=config||{}).type&&"primaries"===config.type?new Model({type:"primaries"}):new PresidentialFeedAPI(config)}});
Modulr.define("fox-news.elections.feeds.2020:api.presidential",["require","jquery","lodash","helper","config","akamai","router","core.plugins:CountdownTimer","core.plugins:DateTime","core.plugins:BrowserVisibilityState","interface/bop","interface/ballot.measures","interface/national","interface/summary","interface/rating","interface/state","interface/state.county","interface/electoral","interface/dial.race.list","interface/dial","normalizations/presidential/admin"],function(require,$,_,Helper){function Model(config){var Proto=this,type=config.type,Router=new RouterInstance(type),FEED_API=Router.getAPI(config.opts||null),TIMER_INIT=!1,CURRENT_TIMER=!1,EVENTS_STACK=[],CURRENT_VISIBILITY=null,REQUIRE_RELOAD=!1;function setTimerInstance(){var endTime=function(time){return time=new Date(time.getTime()+6e4*CONST.refresh)}(AkamaiTime.getCurrent());return new CountdownTimer({endTime:endTime,maxTime:"hours"})}function setEventsTimer(){CURRENT_TIMER&&CURRENT_TIMER.stopCountdowns(),CURRENT_TIMER=setTimerInstance();function trigger(events){events&&"function"==typeof events.onReload&&events.onReload(),CURRENT_TIMER.onTick(function(info){REFRESH_TOOLTIP.update(info),events&&"function"==typeof events.onTick&&events.onTick(info,CONST.refresh)}),CURRENT_TIMER.onDone(function(){events&&"function"==typeof events&&events.onDone(),"hidden"!==CURRENT_VISIBILITY?Proto.reload():(log("Feed reload suspended. Browser was not focused."),REQUIRE_RELOAD=!0)})}for(var i=0;i<EVENTS_STACK.length;i++)trigger(EVENTS_STACK[i])}Visibility.onChange(function(state){!function(state){"hidden"!==CURRENT_VISIBILITY&&null!==CURRENT_VISIBILITY||"visible"!==state||(log("Browser re-focused."),REQUIRE_RELOAD&&(REQUIRE_RELOAD=!1,log("Restarting feed reload.."),Proto.reload()));CURRENT_VISIBILITY=state,new Date}(state)}),Proto._prop={type:type},Proto.API=FEED_API,Proto.reload=function(force){var refreshSecs=60*CONST.refresh;if(CURRENT_TIMER){var info=CURRENT_TIMER.getInfo();(Math.floor(info.raw_ms/1e3)<refreshSecs-5||force)&&(log("[Feed] RELOADING..."),Router.reload(),setEventsTimer())}},Proto.stop=function(){CURRENT_TIMER&&CURRENT_TIMER.stopCountdowns()},Proto.setTimer=function(events){TIMER_INIT?EVENTS_STACK.push(events):(TIMER_INIT=!0,EVENTS_STACK.push(events),setEventsTimer())},Proto.numUpdate=function(target,val,opts){function fmt(n,raw){var nval=raw?n:Math.floor(n);return formatStr.replace("${num}",Helper.dataDisplayStr(opts.format||"num",nval,wholeNum,precisionType))}var ceil,floor,hi=(opts=opts||{}).intervalHi||35,low=opts.intervalLow||20,duration=opts.duration||5e3,precision=opts.precision||!1,precisionType=opts.precisionType||!1,formatStr=opts.formatStr||"${num}",wholeNum=!precisionType,intVal=(ceil=hi,floor=low,Math.floor(Math.floor(Math.random()*(ceil-floor)+1)+floor));if(precision||precisionType)target.html(fmt(val,!0));else if(opts.initial){var startVal=function(val){return val=(val=val.replace(/[^0-9]/g,""))&&!isNaN(val)?parseInt(val,10):0}(target.text());$.numLiveUpdate({val:val,start:startVal,duration:duration,interval:intVal,format:function(n){return Math.floor(n)}},function(n){target.html(fmt(n))})}else target.numLiveUpdate({val:val,duration:duration,interval:intVal,format:function(n){return fmt(n)}})}}var config=require("config"),RouterInstance=require("router"),AkamaiTime=require("akamai").time,CountdownTimer=(require("core.plugins:DateTime"),require("core.plugins:CountdownTimer")),Visibility=(require("normalizations/presidential/admin"),require("core.plugins:BrowserVisibilityState")),log=Helper.log,Interface={BOP:require("interface/bop"),National:require("interface/national"),Summary:require("interface/summary"),Rating:require("interface/rating"),State:require("interface/state"),County:require("interface/state.county"),Ballot:require("interface/ballot.measures"),Electoral:require("interface/electoral"),DialRaceList:require("interface/dial.race.list"),Dial:require("interface/dial")},CONST={refresh:config.FEED_INFO.defaults.refresh||(Helper.feedTestOverride()?.5:1)},REFRESH_TOOLTIP=new function(){var Proto=this,INITIALIZED=!1,ENABLED=!!(Helper.prodTest()||-1<window.location.search.indexOf("_cmodal=1"));Proto.init=function(){if(!ENABLED)return!1;if(INITIALIZED)return!1;INITIALIZED=!0;var html=$('<div class="refersh-countdown-modal"><span>NEXT FEED REFRESH IN >> <span></span></span></div>');html.css({position:"fixed","z-index":9999,display:"block",top:0,left:0,border:"1px solid #000",padding:"12px 14px",background:"#ccc","font-weight":600}),$("body").prepend(html)},Proto.update=function(info){if(!ENABLED)return!1;INITIALIZED||Proto.init();var str=[info.hrs,info.mins,info.secs].join(":");$(".refersh-countdown-modal").find("> span > span").html(str)}};function Instantiate(){var FeedAPI=new Model({type:"presidential"});return function(){log("Initializing election mode switch check..");function triggerReload(val){val=val||"";for(var res=!1,page=window.location.pathname,sp=val.split(";"),found=!1,i=0;i<sp.length;i++){var item=(sp[i]||"").trim();if(/^inc(.+|)\=/.test(item)){found=!0;var regexStr=item.replace(/^inc(.+|)\=/,"")+"$";new RegExp(regexStr,"i").test(page)&&(res=!0)}}return found||(res=!/general-results\/live\-updates/i.test(page)),res}var mode=null,reload=null;FeedAPI.API.admin.getData(function(Feed){mode=Feed.views.electionMode(),reload=Feed.views.reloadMode(),mode&&("pre"===mode?function(){if(!Helper.isElectionDayMode())return;if(Helper.noFeedOverride())return;var timeout=null,interval=6e4*config.FEED_INFO.defaults.modeCheck,trigger=function(){log("Checking election mode switch (1).."),clearTimeout(timeout),FeedAPI.API.admin.getData(function(Feed){var val=Feed.views.electionMode(),rVal=Feed.views.reloadMode();"pre"!==val||reload!==rVal?triggerReload(rVal)?reload=rVal:window.location.reload():timeout=setTimeout(function(){trigger()},interval)})};timeout=setTimeout(function(){trigger()},interval)}():FeedAPI.API.admin.getDataRefresh(function(Feed){log("Checking election mode switch (2)..");var val=Feed.views.electionMode(),rVal=Feed.views.reloadMode();mode===val&&reload===rVal||(triggerReload(rVal)?window.location.reload():reload=rVal)}))})}(),{National:Interface.National(FeedAPI),Summary:Interface.Summary(FeedAPI),State:Interface.State(FeedAPI),County:Interface.County(FeedAPI),Admin:FeedAPI.API.admin,BOP:Interface.BOP(FeedAPI),Electoral:Interface.Electoral(FeedAPI),DialRaceList:Interface.DialRaceList(FeedAPI),Dial:Interface.Dial(FeedAPI),methods:{reload:FeedAPI.reload,setTimer:FeedAPI.setTimer,numUpdate:FeedAPI.numUpdate,electionMode:function(callback){FeedAPI.API.admin.getData(function(Feed){callback(Feed.views.electionMode())})},dataMode:function(callback){var curr=null;Helper.noFeedOverride()?callback(!1):FeedAPI.API.admin.getDataRefresh(function(Feed){var mode=Feed.views.electionMode(),bool=!(!mode||"pre"===mode);null===curr?callback(curr=bool):curr!==bool&&callback(bool)})}}}}return function(){return Instantiate()}});
Modulr.define("fox-news.elections.feeds.2020:config",["require","ENV","SSL","ENV_STATIC_DOMAIN"],function(require,ENV,SSL,STATIC_DOMAIN){var domain,domainWS,info,config={};return config.prefix={candidate:"cid-"},config.party={republican:{id:"R",code:"rep"},democrat:{id:"D",code:"dem"},independent:{id:"I",code:"ind"},green:{id:"GR",code:"gr"},other:{id:"OTH",code:"oth"}},config.CAUCUS_STATES=["AK","CO","HI","ID","IA","KS","KY","ME","MN","NE","NV","ND","WA","WY","DC","AS","MP","PR","VI"],config.STATE_MAP={AL:{name:"Alabama",votes:9},AK:{name:"Alaska",votes:3},AZ:{name:"Arizona",votes:11},AR:{name:"Arkansas",votes:6},CA:{name:"California",votes:55},CO:{name:"Colorado",votes:9},CT:{name:"Connecticut",votes:7},DE:{name:"Delaware",votes:3},DC:{name:"District Of Columbia",votes:3},FL:{name:"Florida",votes:29},GA:{name:"Georgia",votes:16},HI:{name:"Hawaii",votes:4},ID:{name:"Idaho",votes:4},IL:{name:"Illinois",votes:20},IN:{name:"Indiana",votes:11},IA:{name:"Iowa",votes:6},KS:{name:"Kansas",votes:6},KY:{name:"Kentucky",votes:8},LA:{name:"Louisiana",votes:8},ME:{name:"Maine",votes:4},MD:{name:"Maryland",votes:10},MA:{name:"Massachusetts",votes:11},MI:{name:"Michigan",votes:16},MN:{name:"Minnesota",votes:10},MS:{name:"Mississippi",votes:6},MO:{name:"Missouri",votes:10},MT:{name:"Montana",votes:3},NE:{name:"Nebraska",votes:5},NV:{name:"Nevada",votes:6},NH:{name:"New Hampshire",votes:4},NJ:{name:"New Jersey",votes:14},NM:{name:"New Mexico",votes:5},NY:{name:"New York",votes:29},NC:{name:"North Carolina",votes:15},ND:{name:"North Dakota",votes:3},OH:{name:"Ohio",votes:18},OK:{name:"Oklahoma",votes:7},OR:{name:"Oregon",votes:7},PA:{name:"Pennsylvania",votes:20},RI:{name:"Rhode Island",votes:4},SC:{name:"South Carolina",votes:9},SD:{name:"South Dakota",votes:3},TN:{name:"Tennessee",votes:11},TX:{name:"Texas",votes:38},UT:{name:"Utah",votes:6},VT:{name:"Vermont",votes:3},VA:{name:"Virginia",votes:13},WA:{name:"Washington",votes:12},WV:{name:"West Virginia",votes:5},WI:{name:"Wisconsin",votes:10},WY:{name:"Wyoming",votes:3}},config.SPECIAL_STATE_MAP={"ME-At Large":{name:"Maine At Large",votes:2},"ME-District 1":{name:"Maine District 1",votes:1},"ME-District 2":{name:"Maine District 2",votes:1},"NE-At Large":{name:"Nebraska At Large",votes:2},"NE-District 1":{name:"Nebraska District 1",votes:1},"NE-District 2":{name:"Nebraska District 2",votes:1},"NE-District 3":{name:"Nebraska District 3",votes:1}},config.PRESIDENTIAL={electionDate:new Date("11/03/2020 00:00:00"),validNPID:[8639,1036,66288,64542,67957,69341,26932],useElectoralVotesFeed:-1<window.location.search.indexOf("_ecalc"),neededElectoralVotes:270,colors:{party:{rep:"#DD4C4C",dem:"#4691C3",green:"#6db53d",lib:"#ea8147",tie:"#989CA1",other:"#D47643"}},pctReportingPriority:"expectedPercentage",candidateDetails:{8639:{partyName:"Republican",id:"rep",orderId:1},1036:{partyName:"Democrat",id:"dem",orderId:2},66288:{partyName:"Other",id:"oth",orderId:3},64542:{partyName:"Other",id:"oth",orderId:4},67957:{partyName:"Libertarian",id:"lib",orderId:5},69341:{partyName:"Other",id:"oth",orderId:6},26932:{partyName:"Green",id:"gr",orderId:7}}},config.STATE_MAP_BY_NAME=function(){var obj={};for(var code in config.STATE_MAP){var item=config.STATE_MAP[code],name=item.name.toLowerCase();for(var i in obj[name]={code:code},item)obj[name][i]=item[i]}return obj}(),config.FEED_INFO=(info={primaries:{admin:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/1/admin-primaries.json",national:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/1/2020_primary_caucus/aggregate_delegates/${party}/file.json",state_all:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/1/2020_primary_caucus/state_level_results/${party}/file.json",state_code:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/1/2020_primary_caucus/${party}_primary/${code}/state_level_results/file.json",state_counties:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/1/2020_primary_caucus/${party}_primary/${code}/county_level_results/file.json"},presidential:{admin:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/1/admin-general.json",popular_votes:(domain="https://feeds-elections.foxnews.com/archive/politics/elections/2020/${mode}/2020_Generals/")+"President/national_level_results/file.json",national_summary:domain+"${raceId}/national_summary_results/file.json",state_summary:domain+"${raceId}/${stateCode}/state_level_results/file.json",state_county:domain+"${raceId}/${stateCode}/county_level_results/file.json",bop:domain+"Congress/balance_of_power/file.json",ballot_measures:(domainWS="https://feeds-elections.foxnews.com/archive/politics/elections/2020/3/2020_Generals/")+"Initiative/national_summary_results/file.json",electoral:domainWS+"Electoral/file.json",dial_race_list:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/3/polls/dial/race_list.json",dial:"https://feeds-elections.foxnews.com/archive/politics/elections/2020/3/polls/dial/${raceId}/file.json"},defaults:{refresh:.3,modeCheck:.3},callback:!1},-1<window.location.search.indexOf("mode=election_day")&&(info.presidential.admin=info.presidential.admin.replace(/\/\/(.+|)feeds-elections\./,"//stage-feeds-elections.")),info),config.FEED_INFO_OLD=function(){var prefix="/feed/politics/elections/2016",prefix_general="prod"!==ENV&&-1<window.location.search.indexOf("_feed=2012")?"/archive/politics/elections/2012/11/06":"/archive/politics/elections/2016/11/08";["prod","staging"].indexOf(ENV);return SSL&&(prefix_general="/static/partners/2016/elections/feeds"),{overrides:"/politics/elections/2016/feeds/${name}.json",presidential:{tool:(SSL?prefix_general:"/politics/elections/2016/feeds")+"/general-election.json",toolTest:(SSL?prefix_general:"/politics/elections/2016/feeds")+"/general-election.json",ratings:"/politics/elections/2016/feeds/general-election-polls.json",popular_votes:prefix_general+"/President/national-level-results/feed/json/",national_summary:prefix_general+"/${raceId}/national-summary-results/feed/json/",state_summary:prefix_general+"/${raceId}/${stateCode}/state-level-results/feed/json/",state_county:prefix_general+"/${raceId}/${stateCode}/county-level-results/feed/json/",bop:prefix_general+"/Congress/balance-of-power${mode}feed/json/",closing_times:prefix_general+"/states-polls-closing-times/feed/json/",ballot_measures:prefix_general+"/Initiative/national-summary-results/feed/json/"},primaries:{national:prefix+"/${typeId}/aggregate-delegates/${party}/feed/json/",state_all:prefix+"/${typeId}/state-level-results/${party}/feed/json/",state_code:prefix+"/${typeId}/${code}/state-level-results/${party}/feed/json/",state_counties:prefix+"/${typeId}/${code}/county-level-results/${party}/feed/json/"},defaults:{refresh:3,modeCheck:2}}}(),config});
Modulr.define("fox-news.elections.feeds.2020:helper",["require","jquery","lodash","config","ENV","akamai","core.plugins:CommaVal","core.plugins:URLInfo","core.plugins:DateTime","jquery.numLiveUpdate"],function(require,$,_,config,ENV){var CommaVal=require("core.plugins:CommaVal"),URLInfo=require("core.plugins:URLInfo"),DateTime=require("core.plugins:DateTime"),AkamaiTime=require("akamai").time,Helper={getElectionType:function(val){var ret=!1;return/pres/i.test(val)?ret="President":/gov/i.test(val)?ret="Governor":/senate/i.test(val)?ret="Senate":/house/i.test(val)&&(ret="House"),ret},getPartyById:function(id){var ret=null;for(var i in config.party)if(config.party[i].id===id.toUpperCase()){ret=config.party[i];break}return ret},getPartyByCode:function(code){var ret=null;for(var i in config.party)if(config.party[i].code===code.toLowerCase()){ret=config.party[i];break}return ret},getCustomQueryMode:function(){var ret=null,info=new URLInfo(window.location.href).getInfo();return"prod"!==ENV&&info.query&&info.query.mode&&(ret=info.query.mode),ret},prodTest:function(){return-1<window.location.hash.indexOf("_pdtest=1")||"prod"===ENV&&-1<window.location.search.indexOf("mode=election_day")},getElectionModeOverride:function(){var ret=null,mode=Helper.getCustomQueryMode();if(!Helper.prodTest()&&mode&&"prod"!==ENV)switch(mode){case"pre-election":ret="pre";break;case"election-day":ret="during";break;case"post-election":ret="post";break;default:-1<mode.indexOf("election_day")&&(ret="during")}return ret},noFeedOverride:function(){return"prod"!==ENV&&-1<window.location.search.indexOf("_data_feed=0")},isElectionDayMode:function(){var curr=Helper.getAkamaiTime().getTime(),dayOf=config.PRESIDENTIAL.electionDate.getTime(),override=Helper.getElectionModeOverride(),dataOverride=Helper.noFeedOverride(),ret=!1;return"prod"!==ENV?ret=!0:dataOverride||(override&&"pre"!==override||dayOf<=curr)&&(ret=!0),ret},getAkamaiTime:function(){return AkamaiTime.getCurrent("prod"===ENV)},getStateDetails:function(code){return code?config.STATE_MAP[code]?config.STATE_MAP[code]:null:config.STATE_MAP},getAllStatesInfo:function(){return config.STATE_MAP},getPartyByName:function(name){return config.party[$.trim((name||"").toLowerCase())]||null},getPresidentialDetails:function(npid){return config.PRESIDENTIAL.candidateDetails[npid]||null},getPresidentialColors:function(npid){return config.PRESIDENTIAL.colors.candidate[npid]||null},isOtherParty:function(id){var notArr=[config.party.republican.id,config.party.democrat.id];return-1===_.indexOf(notArr,id)},setFeedUrl:function(feed,items){var ret="${feed}".replace("${feed}",feed);for(var i in items)for(var str="${"+i+"}";-1<ret.indexOf(str);)ret=ret.replace(str,items[i]);return ret},throwErrorData:function(msg){return{status:"error",msg:msg}},toLower:function(str){return(str||"").toLowerCase()},capitalize:function(str){return str.charAt(0).toUpperCase()+str.slice(1)},setProp:function(obj,prop,val){return obj[prop]?_.isArray(obj[prop])?obj[prop].push(val):obj[prop]=[obj[prop],val]:obj[prop]=val,obj},setId:function(val){return/[0-9]+/.test(val)?parseInt(val,10):val+""},throwError:function(){var args=Array.prototype.slice.call(arguments),str=["[ElectionFeeds.error]"].concat(args).join(" ");throw new Error(str)},log:function(){var args=Array.prototype.slice.call(arguments);args=[DateTime(AkamaiTime.getCurrent(!0),"[(F) ${hr:mil}:${min}:${sec}]")].concat(args);try{return console.log.apply(console,args)}catch(err){console.log(args)}},orderArrayByKey:function(data,key,order){var arr=_.cloneDeep(data);return arr.sort(function(a,b){var valA=Helper.accessKeyVal(a,key),valB=Helper.accessKeyVal(b,key);return valA<valB?1:valB<valA?-1:0}),"asc"===order.toLowerCase()&&arr.reverse(),arr},accessKeyVal:function(obj,key){for(var sp=key.split("."),ret=_.cloneDeep(obj);0<sp.length;){var iter=sp.shift();if(void 0===ret[iter]){ret=null;break}ret=ret[iter]}return ret},isValidOrderId:function(val){return-1<_.indexOf(["asc","desc"],val.toLowerCase())&&val.toLowerCase()},isNumeric:function(val){return null!=val&&!isNaN(val)},dataDisplayStr:function(type,val,wholeNumber,precisionType){var ret=val=parseFloat(val),decimal="tenth"===precisionType?1:2;switch(type){case"pct":ret=(wholeNumber?Math.round(val):val.toFixed(decimal))+"%";break;case"num":ret=CommaVal(val)}return ret},getPartyIdbyClassName:function(target){return target.hasClass("rep")?"R":!!target.hasClass("dem")&&"D"},getPartyIdbyName:function(val){return"republican"===val?"R":"democrat"===val?"D":"I"},feedTestOverride:function(){return-1<window.location.search.indexOf("mode=test")},noFeedOverride:function(){return-1<window.location.search.indexOf("_data_feed=0")},isDevMode:function(){return-1<window.location.search.indexOf("_devmode=1")},arrayReplace:function(index,len,arr,replaceWith){var args=[index,len].concat(replaceWith);return Array.prototype.splice.apply(arr,args),arr},setOverrideDate:function(dateStr,dayOnly){var sp=dateStr.split("T"),dt=sp[0],tm=dayOnly?"00:00:00":sp[1]||"00:00:00",dts=dt.split("-"),dtf=[dts[1],dts[2],dts[0]].join("/"),date=new Date([dtf,tm].join(" "));return date=Helper.isValidDate(date)?date:null},isValidDate:function(date){return"[object Date]"===Object.prototype.toString.call(date)&&!isNaN(date.getTime())},setLinkStateName:function(val){return val.toLowerCase().replace(/\s+/g," ").replace(/[^a-z0-9]/gi,"-")},isCaucusState:function(code){return-1<$.inArray(code,config.CAUCUS_STATES)},getTimezone:function(zone){return{HST:-5,AKST:-4,PST:-3,MST:-2,CST:-1,EST:0}[zone]||0},setVotesDisplay:function(info){var ret={};for(var i in _.cloneDeep(info)){var type="";switch(i){case"count":case"expected":type="num";break;case"expectedPercentage":case"percentage":case"precinctsReporting":case"reporting":type="pct"}type&&(ret[i]=Helper.dataDisplayStr(type,info[i]))}return ret},setCandidateDisplay:function(info){var ret={};return info.firstName&&info.lastName&&(ret={opt1:[info.firstName,info.lastName].join(" "),opt2:[info.firstName.slice(0,1),info.lastName].join(". "),opt3:[info.lastName,info.firstName].join(", "),opt4:[info.lastName,info.firstName.slice(0,1)+"."].join(", ")}),info.npid&&Helper.isPresidentialNPID(info.npid)&&(ret.party=Helper.getPresidentialDetails(info.npid)),ret},setPrecinctReporting:function(info,returnValueOnly){var val=info[config.PRESIDENTIAL.pctReportingPriority]||info.precinctsReporting||0;if(returnValueOnly)return val;info.FOXPrecinctsReporting=val}};return Helper.setDisplayDetails=function(info){function set(item){item.votes&&(item.votesDisplay=Helper.setVotesDisplay(item.votes)),item.candidate&&item.candidate.firstName&&item.candidate.lastName&&(item.candidateDisplay=Helper.setCandidateDisplay(item.candidate))}if(_.isArray(info))for(var i=0;i<info.length;i++)set(info[i]);else set(info);return info},Helper.resultsByParty=function(data,independentOrder){for(var other=[],info={},items=_.cloneDeep(data);0<items.length;){var item=items.shift(),code=item.partyCode;Helper.isOtherParty(code)?other.push(item):(info[code]||(info[code]=[]),info[code].push(item))}return 0<other.length&&(independentOrder="votes"===independentOrder?"votes":"name",other=Helper.orderArrayByKey(other,"votes"===independentOrder?"votes.count":"candiate.lastName","desc"),info.I=other),info},Helper.numUpdate=function(target,val,opts){var hi=(opts=opts||{}).intervalHi||35,low=opts.intervalLow||20,duration=opts.duration||5e3,precision=opts.precision||!1,precisionType=opts.precisionType||!1,formatStr=opts.formatStr||target.attr("data-num-format")||"${num}",wholeNum=!precisionType;"number"!=typeof target.data("_iter")?target.data("_iter",0):target.data("_iter",target.data("_iter")+1);function fmt(n,raw){return raw||Math.floor(n),formatStr.replace("${num}",Helper.dataDisplayStr(opts.format||"num",wholeNum,precisionType))}var ceil,floor,iter=target.data("_iter"),initial="boolean"==typeof opts.initial?opts.initial:0<iter,intVal=(ceil=hi,floor=low,Math.floor(Math.floor(Math.random()*(ceil-floor)+1)+floor));if(precision||val%1!=0||precisionType)target.html(fmt(val,!0));else if(initial){var startVal=function(val){return val=(val=val.replace(/[^0-9]/g,""))&&!isNaN(val)?parseInt(val,10):0}(target.text());$.numLiveUpdate({val:val,start:startVal,duration:duration,interval:intVal,format:function(n){return Math.floor(n)}},function(n){target.html(fmt(n))})}else target.numLiveUpdate({val:val,duration:duration,interval:intVal,format:function(n){return fmt(n)}})},Helper.cacheBuster=function(){var current=AkamaiTime.getCurrent(!0),secs=DateTime(current,"${sec}"),ret=DateTime(current,"${yr}${mm}${dd}${hr:mil}${min}");return ret+=secs<=30?30:1},Helper.isPresidentialNPID=function(val){return!!val},Helper.setStateUrl=function(code){var info=config.STATE_MAP[code]||null,ret=null;if(info&&info.name){var pretty=null;if(pretty=info.name.toLowerCase().replace(/\s+/g,"-")){window.location.host;ret=[Helper.getElectionHostUrl(),"/politics/elections/2020/state-races/",pretty].join("")}}return ret},Helper.getElectionHostUrl=function(){var host=window.location.host,ret="//www.foxnews.com";return"prod"!==ENV&&-1<host.indexOf("elections.foxnews.com")&&(ret="//"+host),ret},Helper.IEtheSpecialChildDateConvert=function(val){var sp=val.split(" "),dts=sp[0].split("-");return[[dts[1],dts[2],dts[0]].join("/"),sp[1]].join(" ")},Helper.isSplitState=function(code){return-1<["ME","NE"].indexOf(code)},Helper});
Modulr.define("fox-news.elections.feeds.2020:interface/ballot.measures",["require","jquery","helper"],function(require,$,Helper){return function(FeedAPI){var opts={typeId:"ballot_measures"};function getData(type,callback){FeedAPI.API.ballot[type](opts,function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(callback){getData("getData",callback)},getDataRefresh:function(callback){getData("getDataRefresh",callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/bop",["require","jquery","lodash","helper"],function(require,$,_,Helper){return function(FeedAPI){var opts={typeId:"bop"};function getData(type,moreOpts,callback){FeedAPI.API.bop[type](function(moreOpts){var obj={feedData:{raceId:"Congress",mode:"/"+(moreOpts&&"direct"===moreOpts.mode?"":"c/")}};return _.merge(obj,_.cloneDeep(opts))}(moreOpts),function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(){var callback=null,moreOpts=null,args=arguments;"function"==typeof args[0]?callback=args[0]:"function"==typeof args[1]&&(moreOpts="object"==typeof args[0]?args[0]:null,callback=args[1]),getData("getData",moreOpts,callback)},getDataRefresh:function(){var callback=null,moreOpts=null,args=arguments;"function"==typeof args[0]?callback=args[0]:"function"==typeof args[1]&&(moreOpts=args[0],callback=args[1]),getData("getDataRefresh",moreOpts,callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/dial",["require","jquery","lodash","helper"],function(require,$,_,Helper){return function(FeedAPI){var opts={typeId:"dial"};function getData(type,raceId,callback){FeedAPI.API.dial[type](function(raceId){var obj={feedData:{raceId:raceId}};return _.merge(obj,_.cloneDeep(opts))}(raceId),function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(raceId,callback){getData("getData",raceId,callback)},getDataRefresh:function(raceId,callback){getData("getDataRefresh",raceId,callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/dial.race.list",["require","jquery","helper"],function(require,$,Helper){return function(FeedAPI){var opts={typeId:"dial_race_list"};function getData(type,callback){FeedAPI.API.dialRaceList[type](opts,function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(callback){getData("getData",callback)},getDataRefresh:function(callback){getData("getDataRefresh",callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/electoral",["require","jquery","helper"],function(require,$,Helper){return function(FeedAPI){var opts={typeId:"electoral",feedData:{raceId:"President"}};function getData(type,callback){FeedAPI.API.electoral[type](opts,function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(callback){getData("getData",callback)},getDataRefresh:function(callback){getData("getDataRefresh",callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/national",["require","jquery","helper"],function(require,$,Helper){return function(FeedAPI){var opts={typeId:"national",feedData:{raceId:"President"}};function getData(type,callback){FeedAPI.API.national[type](opts,function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(callback){getData("getData",callback)},getDataRefresh:function(callback){getData("getDataRefresh",callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/rating",["require","jquery","helper","core.plugins:URLInfo","core.plugins:DateTime"],function(require,$,Helper){var URLInfo=require("core.plugins:URLInfo");require("core.plugins:DateTime"),new URLInfo(window.location.href).getInfo().query;return function(FeedAPI){var opts={typeId:"ratings"};return{getData:function(callback){FeedAPI.API.ratings.getData(opts,function(data){callback(data)})},getDataRefresh:function(callback){FeedAPI.API.ratings.getDataRefresh(opts,function(data){callback(Helper.isDevMode()?data:{views:data.views})})}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/state.county",["require","jquery","lodash","helper"],function(require,$,_,Helper){return function(FeedAPI){var opts={typeId:"state_county"};function getData(type,raceId,stateCode,callback){raceId=Helper.capitalize(raceId),FeedAPI.API.county[type](function(raceId,stateCode){var obj={feedData:{raceId:raceId,stateCode:stateCode}};return _.merge(obj,_.cloneDeep(opts))}(raceId,stateCode),function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(raceId,stateCode,callback){getData("getData",raceId,stateCode,callback)},getDataRefresh:function(raceId,stateCode,callback){getData("getDataRefresh",raceId,stateCode,callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/state",["require","jquery","lodash","helper"],function(require,$,_,Helper){return function(FeedAPI){var opts={typeId:"state_summary"};function getData(type,raceId,stateCode,callback){raceId=Helper.capitalize(raceId),FeedAPI.API.state[type](function(raceId,stateCode){var obj={feedData:{raceId:raceId,stateCode:stateCode}};return _.merge(obj,_.cloneDeep(opts))}(raceId,stateCode),function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(raceId,stateCode,callback){getData("getData",raceId,stateCode,callback)},getDataRefresh:function(raceId,stateCode,callback){getData("getDataRefresh",raceId,stateCode,callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:interface/summary",["require","jquery","lodash","helper"],function(require,$,_,Helper){return function(FeedAPI){var opts={typeId:"national_summary"};function getData(type,raceId,callback){raceId=Helper.capitalize(raceId),FeedAPI.API.summary[type](function(raceId){var obj={feedData:{raceId:raceId}};return _.merge(obj,_.cloneDeep(opts))}(raceId),function(data){callback(Helper.isDevMode()?data:{views:data.views})})}return{getData:function(raceId,callback){getData("getData",raceId,callback)},getDataRefresh:function(raceId,callback){getData("getDataRefresh",raceId,callback)}}}});
Modulr.define("fox-news.elections.feeds.2020:models/_main",["require","lodash","config","helper","ENV","core.plugins:MultiFeedParser","core.plugins:DateTime"],function(require,_,config,Helper,ENV){var MultiFeedParser=require("core.plugins:MultiFeedParser"),Parser=(require("core.plugins:DateTime"),config.FEED_INFO,Helper.log,new MultiFeedParser({initOnLoad:!0,cacheStrFN:function(){return Helper.cacheBuster()}})),INSTNANCE_STORE={},CALLBACK_ITER=0;return new function(){function processCallbacks(id,data){for(var instance=INSTNANCE_STORE[id],i=0;i<instance.callbackStack.length;i++){(0,instance.callbackStack[i])(data)}}this.reload=function(id){Parser.event.reload(id||!1)},this.get=function(id,opts,callback){if(INSTNANCE_STORE[id]){opts.refresh;Parser.event.getData(id,function(data){var raw=data&&data.data?data.data:data;callback(raw,!0)}),opts.refresh&&(INSTNANCE_STORE[id].callbackStack.push(callback),INSTNANCE_STORE[id].refreshInit||(INSTNANCE_STORE[id].refreshInit=!0,Parser.event.onLoad(id,function(data){var raw=data&&data.data?data.data:data;INSTNANCE_STORE[id].data=raw,processCallbacks(id,raw),callback(raw)})))}else{INSTNANCE_STORE[id]={opts:opts,refreshInit:!1,callbackStack:[]},CALLBACK_ITER++;var feedOpts={type:id,url:opts.url};(opts.callback||config.FEED_INFO.callback)&&(feedOpts.jsonpCallback="elect20_"+CALLBACK_ITER),Parser.event.addFeed(feedOpts),opts.refresh?(INSTNANCE_STORE[id].refreshInit=!0,Parser.event.onLoad(id,function(data){var raw=data&&data.data?data.data:data;INSTNANCE_STORE[id].data=raw,processCallbacks(id,raw),callback(raw)})):Parser.event.getData(id,function(data){var raw=data&&data.data?data.data:data;callback(raw,!0)})}},this.setUID=function(arr){return arr.join("/")},this.processFeedUrl=function(url,items){for(var id in items)for(var match="${"+id+"}";-1<url.indexOf(match);)url=url.replace(match,items[id]);return url},this.processCandidatesList=function(candidates){for(var info={library:{},lookup:{cssId:{},lastName:{}}},i=0;i<candidates.length;i++){var person=candidates[i],pnpid=person.npid,cssId=config.prefix.candidate+pnpid,lastName=Helper.toLower(person.lastName);person.cssId=cssId,info.library[pnpid]={info:person},info.lookup.cssId[cssId]=pnpid,info.lookup.lastName=Helper.setProp(info.lookup.lastName,lastName,pnpid)}return info}}});
Modulr.define("fox-news.elections.feeds.2020:models/base/admin",["require","jquery","lodash","helper","config","models/_main"],function(require,$,_,Helper,config){var Parser=require("models/_main");return function(type,Normalizations,Views){var Proto=this,ID_PREFIX=[type,"eadmin"].join("/");Proto.getData=function(callback,refresh){var opts={};!function(callback,refresh){var id=Parser.setUID([ID_PREFIX]),feed=Helper.setFeedUrl(config.FEED_INFO[type].admin),opts={};Parser.get(id,{url:feed,refresh:refresh||!1},function(data){callback(function(raw,opts){var data={};return data.raw=raw,data.norm=new Normalizations(data,opts),data}(data,opts))})}(function(data){var info={data:data};info.views=new Views(info.data,opts),callback(info)},refresh)},Proto.getDataRefresh=function(callback){Proto.getData(function(data){callback(data)},!0)},Proto.reload=function(id){Parser.reload(id)}}});
Modulr.define("fox-news.elections.feeds.2020:models/base/national",["require","jquery","lodash","helper","config","models/_main"],function(require,$,_,Helper,config){var Parser=require("models/_main");return function(type,typeId,Normalizations,Views,Admin){var Proto=this,ID_PREFIX=[type,"national"].join("/");function getFeed(party,callback,refresh){var id=Parser.setUID([ID_PREFIX,party]),feed=Helper.setFeedUrl(config.FEED_INFO[type].national,{party:party,typeId:typeId}),opts={party:party};Parser.get(id,{url:feed,refresh:refresh||!1},function(data){Admin.getData(function(adminData){callback(function(raw,opts,adminData){var data={};return data.raw=raw,data.norm=new Normalizations(data,opts,adminData),data}(data,opts,adminData))})})}Proto.getData=function(callback,refresh){var opts={};getFeed("R",function(GOP_DATA){getFeed("D",function(DEM_DATA){Admin.getData(function(adminData){var info={data:{R:GOP_DATA,D:DEM_DATA}};info.views=new Views(info.data,opts,adminData),callback(info)})})},refresh)},Proto.getDataRefresh=function(callback){Proto.getData(function(data){callback(data)},!0)},Proto.reload=function(id){Parser.reload(id)}}});
Modulr.define("fox-news.elections.feeds.2020:models/base/state",["require","jquery","lodash","helper","config","models/_main"],function(require,$,_,Helper,config){var Parser=require("models/_main");return function(type,typeId,Normalizations,Views,Admin){var Proto=this,ID_PREFIX=[type,"state"].join("/");function getFeed(opts,party,callback,refresh){var code=opts.code||"",dataType=opts.dataType,id=Parser.setUID([ID_PREFIX,party,dataType,code]),feed=Helper.setFeedUrl(config.FEED_INFO[type]["state_"+dataType],{code:code,party:party,typeId:typeId});Parser.get(id,{url:feed,refresh:refresh||!1},function(data){Admin.getData(function(adminData){callback(function(raw,opts,adminData){var data={};return data.raw=raw,data.norm=new Normalizations(data,opts,adminData.data),data}(data,opts,adminData))})})}Proto.getData={all:function(callback,refresh){var opts={dataType:"all"};getFeed(opts,"R",function(GOP_DATA){getFeed(opts,"D",function(DEM_DATA){Admin.getData(function(adminData){var info={data:{R:GOP_DATA,D:DEM_DATA}};info.views=new Views(info.data,opts,adminData.data),callback(info)})})},refresh)},allRefresh:function(callback){Proto.getData.all(function(data){callback(data)},!0)},stateCode:function(code,callback,refresh){var opts={dataType:"code",code:code};getFeed(opts,"R",function(GOP_DATA){getFeed(opts,"D",function(DEM_DATA){Admin.getData(function(adminData){var info={data:{R:GOP_DATA,D:DEM_DATA}};info.views=new Views(info.data,opts,adminData),callback(info)})})},refresh)},stateCodeRefresh:function(code,callback){Proto.getData.stateCode(code,function(data){callback(data)},!0)},stateCounties:function(props,callback,refresh){var code=props;"object"==typeof props&&(code=props.code,props.demId&&props.demId,props.repId&&props.repId);var opts={dataType:"counties",code:code};props&&props.party&&"D"===props.party[0]?getFeed(opts,props.party,function(DEM_DATA){Admin.getData(function(adminData){var info={data:{D:DEM_DATA}};info.views=new Views(info.data,opts,adminData),callback(info)})},refresh):props&&props.party&&"R"===props.party[0]?getFeed(opts,props.party,function(GOP_DATA){Admin.getData(function(adminData){var info={data:{R:GOP_DATA}};info.views=new Views(info.data,opts,adminData),callback(info)})},refresh):getFeed(opts,"R",function(GOP_DATA){getFeed(opts,"D",function(DEM_DATA){Admin.getData(function(adminData){var info={data:{R:GOP_DATA,D:DEM_DATA}};info.views=new Views(info.data,opts,adminData),callback(info)})})},refresh)},stateCountiesRefresh:function(code,callback){Proto.getData.stateCounties(code,function(data){callback(data)},!0)}},Proto.reload=function(id){Parser.reload(id)}}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/admin",["require","jquery","lodash","helper","config","models/base/admin","normalizations/presidential/admin","views/presidential/admin"],function(require,$,_,Helper,config){var BaseModel=require("models/base/admin"),Normalizations=require("normalizations/presidential/admin"),Views=require("views/presidential/admin");return new BaseModel("presidential",Normalizations,Views)});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/ballot.measures",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/ballot.measures","views/presidential/ballot.measures"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/ballot.measures"),Views=require("views/presidential/ballot.measures");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/base",["require","jquery","lodash","helper","config","models/_main","models/presidential/admin"],function(require,$,_,Helper,config){var Parser=require("models/_main"),Admin=require("models/presidential/admin");return function(type,Normalizations,Views,opts){var Proto=this,CURRENT_DATASET={};function getFeed(conf,callback,refresh,customId,returnRaw,admin){var res,feedTypeId=customId||conf.typeId,raceId=conf.feedData&&conf.feedData.raceId?conf.feedData.raceId:"rc",stateCode=conf.feedData&&conf.feedData.stateCode?conf.feedData.stateCode:"st",id=Parser.setUID(["general_elec",type,feedTypeId,raceId,stateCode]),feed=Helper.setFeedUrl(config.FEED_INFO[type][feedTypeId],_.merge(conf.feedData||{},{mode:(res=_.get(admin,"data.raw.generalsettings.outagePlan","3"),-1<window.location.search.indexOf("3t=1")&&(res="1"),res)}));_.get(admin,"data.raw.generalsettings.powerByStage",!1)&&(feed=feed.replace(/\/\/(.+|)feeds-elections\./,"//stage-feeds-elections.")),Parser.get(id,{url:feed,refresh:refresh||!1},function(data,isCurrent){callback(returnRaw?data:Normalize(data,conf,admin,isCurrent,id),isCurrent)})}function Normalize(raw,conf,admin,isCurrent,id){var data={};return data.raw=_.cloneDeep(raw),data.norm=new Normalizations(data,conf,admin),CURRENT_DATASET[id]=data,CURRENT_DATASET[id]}opts=opts||{},Proto.getData=function(conf,callback,refresh){conf=conf||{},_.merge(conf,_.cloneDeep(opts)),Admin.getData(function(admin){"national"===conf.typeId?getFeed(conf,function(POPULAR_VOTES,isCurrentPopular){getFeed(conf,function(NATIONAL_SUMMARY,isCurrentNational){var info={data:{popular:POPULAR_VOTES,summary:NATIONAL_SUMMARY}},isCurrentSummary=!(!isCurrentPopular||!isCurrentNational);info.data=Normalize(info.data,conf,admin,isCurrentSummary,"national_summary_all"),info.views=new Views(info.data,conf,admin),callback(info)},null,"national_summary",!0,admin)},refresh,"popular_votes",!0,admin):getFeed(conf,function(data){var info={data:data};info.views=new Views(info.data,conf,admin),callback(info)},refresh,null,null,admin)})},Proto.getDataRefresh=function(conf,callback){Proto.getData(conf,function(data){callback(data)},!0)},Proto.reload=function(id){Parser.reload(id)}}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/bop",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/bop","views/presidential/bop"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/bop"),Views=require("views/presidential/bop");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/dial",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/dial","views/presidential/dial"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/dial"),Views=require("views/presidential/dial");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/dial.race.list",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/dial.race.list","views/presidential/dial.race.list"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/dial.race.list"),Views=require("views/presidential/dial.race.list");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/electoral",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/electoral","views/presidential/electoral"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/electoral"),Views=require("views/presidential/electoral");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/national",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/national","views/presidential/national"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/national"),Views=require("views/presidential/national");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/ratings",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/ratings","views/presidential/ratings"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/ratings"),Views=require("views/presidential/ratings");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/state.county",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/state.county","views/presidential/state.county"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/state.county"),Views=require("views/presidential/state.county");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/state",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/state","views/presidential/state"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/state"),Views=require("views/presidential/state");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/presidential/summary",["require","jquery","lodash","helper","config","models/presidential/base","normalizations/presidential/summary","views/presidential/summary"],function(require,$,_,Helper,config){var BaseModel=require("models/presidential/base"),Normalizations=require("normalizations/presidential/summary"),Views=require("views/presidential/summary");return function(opts){return new BaseModel("presidential",Normalizations,Views,opts)}});
Modulr.define("fox-news.elections.feeds.2020:models/primaries/admin",["require","jquery","lodash","helper","config","models/base/admin","normalizations/primaries/admin","views/primaries/admin"],function(require,$,_,Helper,config){var BaseModel=require("models/base/admin"),Normalizations=require("normalizations/primaries/admin"),Views=require("views/primaries/admin");return new BaseModel("primaries",Normalizations,Views)});
Modulr.define("fox-news.elections.feeds.2020:models/primaries/national",["require","jquery","lodash","helper","config","models/base/national","normalizations/primaries/national","views/primaries/national","models/primaries/admin"],function(require,$,_,Helper,config){var BaseModel=require("models/base/national"),Normalizations=require("normalizations/primaries/national"),Views=require("views/primaries/national"),Admin=require("models/primaries/admin");return function(primaryId){return new BaseModel("primaries",primaryId,Normalizations,Views,Admin)}});
Modulr.define("fox-news.elections.feeds.2020:models/primaries/state",["require","jquery","lodash","helper","config","models/base/state","normalizations/primaries/state","views/primaries/state","models/primaries/admin"],function(require,$,_,Helper,config){var BaseModel=require("models/base/state"),Normalizations=require("normalizations/primaries/state"),Views=require("views/primaries/state"),Admin=require("models/primaries/admin");return function(primaryId){return new BaseModel("primaries",primaryId,Normalizations,Views,Admin)}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/admin",["require","jquery","lodash","config","helper","akamai"],function(require,$,_,config,Helper){return function(data){var mode,ret,override,Proto=this,raw=data.raw,CURRENT_TIME=Helper.getAkamaiTime();function setPollStatus(data){var open=data.open,close=data.close,status=null;if(open&&close)try{open=setPollDate(open),close=setPollDate(close),status=CURRENT_TIME<open?"pre":close<CURRENT_TIME?"post":"open"}catch(err){console.log(err)}return{open:open,close:close,status:status}}function setPollDate(val){var date=null;return Helper.isValidDate(val)?val:(val&&"string"==typeof val&&(date=Helper.setOverrideDate(val)),date)}Proto.splits=function(results){function set(code,data){for(var id in data){var npid=data[id];if(npid){npid=parseInt(npid,10);var val="most_popular"===id?3:-1<id.indexOf("district_")?1:0;val&&(info[code][npid]||(info[code][npid]=0),info[code][npid]=info[code][npid]+val)}}}for(var states=["ME","NE"],info={},i=0;i<states.length;i++){var code=states[i];info[code]={},results&&results[code]&&set(code,results[code])}return info}(raw.splits||null),Proto.states=function(states){var info={};for(var id in states){var item=states[id];item.pollTimes=setPollStatus(item.pollTimes),info[id]=item,Helper.isSplitState(id)&&(info[id].splitInfo=Proto.splits[id])}return info}(raw.states),Proto.dial=function(items){var val,match,res,map={foxnews_dial_mode:"fnc",election_home_dial_mode:"landing",states_dial_mode:"states"},info={};for(var id in items){var uid=map[id]||null;uid&&(info[uid]={disable:(val=items[id],void 0,res=void 0,match=val?val.match(/hide_(.+)/):null,res=null,Array.isArray(match)&&0<match.length&&match[1]&&(res=match[1]),res),value:items[id]})}return info}(raw.dial||{}),Proto.candidates=function(candidates){var info={};for(var npid in candidates){var item=candidates[npid];info[npid]=item}return info}(_.cloneDeep(raw.candidates)),Proto.electoralVotes=function(items){var val,ret,info={states:{},splits:{},total:0};for(var code in items){var item=items[code],votes=(val=item.electoral_votes,ret=void 0,ret=null,val&&!isNaN(val)&&(ret=parseInt(val,10)),ret);(votes=votes||(config.STATE_MAP[code]?config.STATE_MAP[code].votes:0))&&(info.total=info.total+votes,info.states[code]=votes),Helper.isSplitState(code)&&(info.splits[code]=Proto.splits[code]||{})}return info}(raw.states),Proto.electionMode=(mode=raw.generalsettings.electionMode,ret=null,override=Helper.getElectionModeOverride(),ret=override||(mode&&"number"==typeof mode?[null,"pre","during","post"][mode]:"pre"),Helper.prodTest()&&(ret="during"),ret)}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/ballot.measures",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var raw=data.raw;function getWinner(results){for(var ret=null,i=0;i<results.length;i++){var item=results[i];if(item.isWinner){ret=item;break}}return ret}this.results=function(data){for(var i=0;i<data.length;i++){var item=data[i],results=item.results;Helper.setDisplayDetails(results),Helper.setPrecinctReporting(item),item.winner=getWinner(results)}return data}(_.cloneDeep(raw)),this.resultsByState=function(results){for(var info={},i=0;i<results.length;i++){var item=results[i],code=item.stateCode;code&&item.stateCode===code&&(info[code]=$.isArray(info[code])?info[code]:[],info[code].push(item))}return info}(this.results)}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/bop",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var raw=data.raw;this.results=function(races){function set(race,results){var partyInfo,party={};for(var p in results.startValues)party[(partyInfo=Helper.getPartyById(p)).code]||(party[partyInfo.code]={}),party[partyInfo.code].start=results.startValues[p];for(var i=0;i<results.partyResults.length;i++){var item=results.partyResults[i];party[(partyInfo=Helper.getPartyById(item.partyCode)).code]||(party[partyInfo.code]={}),party[partyInfo.code].curr=item.count,party[partyInfo.code].gain=item.gain}var info={details:party,totals:results.totals};dataset[race.toLowerCase()]=info}var dataset={};for(var race in races){races[race];set(race,races[race])}return dataset}(_.cloneDeep(raw))}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/dial",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var raw=data.raw;this.results=function(data){var raceType=data.race_id?data.race_id.substring(3,4):"";return{results:data,raceType:function(val){return{G:"Governor",S:"Senate",P:"Presidential"}[val]||"Unknown"}(raceType)}}(_.cloneDeep(raw)),this.resultsPage=function(items){for(var info={},i=0;i<items.length;i++){var item=items[i];if(item.race_id){var raceId=item.race_id;raceId&&(info[raceId]=$.isArray(info[raceId])?info[raceId]:[],info[raceId].push(item))}else Helper.log("warning: invalid dial data:",item)}return info}(_.cloneDeep(raw))}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/dial.race.list",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var raw=data.raw,racesByState={};this.results=function(data){return data&&function(){for(var i=0;i<data.length;i++){var raceId=data[i],stateCode=raceId.substring(0,2);stateCode&&(racesByState[stateCode]=$.isArray(racesByState[stateCode])?racesByState[stateCode]:[],racesByState[stateCode].push(raceId))}}(),data}(_.cloneDeep(raw)),this.racesByState=racesByState}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/electoral",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var raw=data.raw;this.results=function(races){function set(race,results){var info={results:results,time:results.callTime,winner:results.candidates[0]};dataset[results.stateCode]=info}var dataset={};for(var race in races){races[race];set(0,races[race])}return dataset}(_.cloneDeep(raw))}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/national",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var results,raw=data.raw,winner=[],candidatesById=function(candidates){for(var info={},i=0;i<candidates.length;i++){var item=candidates[i];Helper.isPresidentialNPID(item.npid)&&(info[item.npid]=item)}return info}(raw.summary.candidates);function getStateResults(npid,data){var info={};for(var code in data){var item=data[code];info[code]=stateSummary(npid,item.results)}return info}function stateSummary(npid,arr){for(var ret=null,i=0;i<arr.length;i++){var item=arr[i];parseInt(item.candidateNpid,10)===parseInt(npid,10)&&(ret=item)}return ret}function setCandidateResultsDetails(arr,byId){for(var ret=byId?{}:[],hasVotes=!1,hasWinner=!1,i=0;i<arr.length;i++){var item=arr[i],npid=item.candidateNpid;Helper.isPresidentialNPID(npid)&&(item.candidate=candidatesById[npid],item=Helper.setDisplayDetails(item),!hasVotes&&item.votes&&"number"==typeof item.votes.count&&0<item.votes.count&&(hasVotes=!0),!hasWinner&&item.isWinner&&(hasWinner=!0),byId?ret[npid]=item:ret.push(item))}return!byId&&$.isArray(ret)&&hasVotes&&(ret=function(items){var winner=[],toOrder=[];for(;0<items.length;){var item=items.shift();item.isWinner?winner.push(item):toOrder.push(item)}0<winner.length&&1<winner.length&&(winner=Helper.orderArrayByKey(winner,"votes.count","desc"));return toOrder=Helper.orderArrayByKey(toOrder,"votes.count","desc"),winner.concat(toOrder)}(ret)),ret}function getElectoralVotes(npid,candidateInfo,summaryInfo){var electoralInfo=admin.data.norm.electoralVotes,states=candidateInfo.stateResults,map=electoralInfo.states,useFeedElectoral=(electoralInfo.splits,!(!config.PRESIDENTIAL.useElectoralVotesFeed||"number"!=typeof candidateInfo.electoralVotes)),info={states:[],total:useFeedElectoral?candidateInfo.electoralVotes:0};for(var code in states){var abbrev=code.slice(0,2),splitState=Helper.isSplitState(abbrev);if(states[code]&&map[code])!!summaryInfo[code].winner&&states[code].isWinner&&(info.states.push(code),useFeedElectoral&&(info.total=info.total+map[code]));else if(states[code]&&splitState){if(!!summaryInfo[code].winner&&states[code].isWinner&&(info.states.push(code),useFeedElectoral)){var votes=config.SPECIAL_STATE_MAP[code]?config.SPECIAL_STATE_MAP[code].votes:summaryInfo[code].availableDelegates?summaryInfo[code].availableDelegates:0;info.total=info.total+votes}}}return info.needToWin=config.PRESIDENTIAL.neededElectoralVotes-info.total,info.needToWin<0&&(info.needToWin=0),info}function hasVotes(items){for(var ret=!1,i=0;i<items.length;i++){if(0<items[i].votes.count){ret=!0;break}}return ret}this.resultsByPopularVote=function(results){results=Helper.orderArrayByKey(results,"votes.count","desc");for(var info=[],i=0;i<results.length;i++){var item=results[i];Helper.isPresidentialNPID(item.candidate.npid)&&info.push(Helper.setDisplayDetails(item))}return info}(raw.popular.candidateResults),this.stateSummary=function(summary){for(var info={},i=0;i<summary.length;i++){var item=summary[i];Helper.setPrecinctReporting(item),item.results=setCandidateResultsDetails(item.results),item.resultsByCandidateId=setCandidateResultsDetails(item.results,!0),item.stateAdminInfo=admin.views.stateInfo(item.stateCode.slice(0,2)),item.winner=item.results[0].isWinner?item.results[0].candidate.npid:null,item.lead=item.results[0].candidate.npid,item.hasVotes=hasVotes(item.results),info[item.stateCode]=item}return info}(raw.summary.stateResults),this.results=function(results,summary){for(var info={},i=0;i<results.length;i++){var item=results[i],npid=item.candidate.npid;Helper.isPresidentialNPID(npid)&&(item.isWinner&&winner.push(npid),info[npid]=item,info[npid].stateResults=getStateResults(npid,summary),info[npid].electoralVotes=getElectoralVotes(npid,info[npid],summary))}return info}(this.resultsByPopularVote,this.stateSummary),this.resultsByElectoralVote=(results=_.cloneDeep(this.resultsByPopularVote),results=Helper.orderArrayByKey(results,"electoralVotes","desc")),this.winner=winner,this.electoralVotesStatus=function(results){var electoralInfo=admin.data.norm.electoralVotes,info={byCandidateNpid:{},total:electoralInfo.total,remaining:electoralInfo.total,needed:config.PRESIDENTIAL.neededElectoralVotes};for(var npid in results){var item=results[npid].electoralVotes;info.byCandidateNpid[npid]=item,info.remaining=info.remaining-item.total}return info}(this.results),this.popularResultsByCandidateId=function(results){var info={};for(var cand in results){var item=results[cand];info[item.candidate.npid]=item}return info}(raw.popular.candidateResults)}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/ratings",["require","jquery","lodash","config","helper","core.plugins:DateTime"],function(require,$,_,config,Helper){require("core.plugins:DateTime");return function(data){function setItems(arr){for(var i=0;i<arr.length;i++){var item=arr[i];item.date=setTime(item.date),item.rating&&(item.rating=setRating(item.rating)),item.favorability&&(item.favorability=setRating(item.favorability))}return arr}function setRating(info){var obj={};for(var id in info)for(var i=0;i<info[id].length;i++)obj[id.toLowerCase()]||(obj[id.toLowerCase()]=[]),obj[id.toLowerCase()][i]=setPct(info[id][i]);return obj}function setPct(val){return val=isNaN(val)?0:parseFloat((parseFloat(val)/100).toFixed(2))}function setTime(val){var date=(-1<val.indexOf("T")?val.split("T"):val.split(" "))[0];return date=[(date=date.split("-"))[1],date[2],date[0]].join("/"),new Date([date,"00:00:00"].join(" "))}this.ordered=function(info){function set(type,item){var alt="rating"===type?"favorability":"rating",tmp=_.cloneDeep(item);if(tmp[alt])try{delete tmp[alt]}catch(err){tmp[alt]=null}obj[type].push(tmp)}for(var obj={rating:[],favorability:[]},i=0;i<info.length;i++){var item=info[i];item.rating||item.favorability?(item.rating&&set("rating",item),item.favorability&&set("favorability",item)):(set("rating",item),set("favorability",item))}for(var id in obj)obj[id]=setItems(obj[id]);return obj}(_.cloneDeep(data.raw))}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/state.county",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var Proto=this,raw=data.raw,resultsByCounty={},IS_PRESIDENTIAL=!(!opts||!opts.feedData||"President"!==opts.feedData.raceId);function setFips(arr){for(var i=0;i<arr.length;i++){var item=arr[i];arr[i].fipsCode=raw.lookup.counties[item.countyId].fipsCode,Helper.setDisplayDetails(arr[i])}return arr}function setByFips(arr,candidate){for(var info={},i=0;i<arr.length;i++){var item=arr[i];Helper.setDisplayDetails(item),setResultsByCounty(info[item.fipsCode]=item,candidate)}return info}function setResultsByCounty(item,candidate){if(!resultsByCounty[item.fipsCode]){Proto.lookup[item.fipsCode]&&Proto.lookup[item.fipsCode].precinctsReporting;resultsByCounty[item.fipsCode]={precinctsReporting:Proto.lookup[item.fipsCode]||null,candidateList:{},lead:[]}}var res=resultsByCounty[item.fipsCode],cInfo={candidate:candidate,votes:item.votes};res.candidateList[candidate.npid]=cInfo,0<item.votes.count&&(0===res.lead.length?res.lead.push(cInfo):item.votes.count>res.lead[0].votes.count?res.lead=[cInfo]:item.votes.count===res.lead[0].votes.count&&res.lead.push(cInfo)),Helper.setDisplayDetails(res.candidateList[candidate.npid])}function orderCandidateList(item){var voteArr=[],presArr=[],toOrder=[],hasVotes=!1;for(var npid in item.candidateList){var npid_int=parseInt(npid,10);if(0<item.candidateList[npid].votes.count)hasVotes=!0,voteArr.push(item.candidateList[npid]);else if(-1<[8639,1036].indexOf(npid_int))presArr[8639===npid_int?"unshift":"push"](item.candidateList[npid]);else toOrder.push(item.candidateList[npid])}var sort=hasVotes?"desc":"asc";1<voteArr.length&&(voteArr=Helper.orderArrayByKey(voteArr,"votes.count",sort)),toOrder=Helper.orderArrayByKey(toOrder,"candidate.lastName","asc");var sorted=presArr.concat(toOrder);return voteArr.concat(sorted)}Proto.lookup=function(lookup){var info={};for(var i in lookup){var item=lookup[i],fips=item.fipsCode;0!==fips&&(item.name=$.trim(item.name),item.countyId=item.number,item.precinctsReporting={val:item.precinctsReporting,displayStr:Helper.dataDisplayStr("pct",item.precinctsReporting,!0)},delete item.number,0!==fips&&(info[fips]=item))}return info}(_.cloneDeep(raw.lookup.counties)),Proto.results=function(results){for(var info={},i=0;i<results.length;i++){var item=results[i];(!IS_PRESIDENTIAL||!!Helper.isPresidentialNPID(item.candidate.npid))&&(Helper.setDisplayDetails(item),item.countyVotes=setFips(item.countyVotes),item.countyVotesByFips=setByFips(_.cloneDeep(item.countyVotes),item.candidate),info[item.candidate.npid]=item)}return info}(_.cloneDeep(raw.results)),Proto.resultsByCounty=function(results){for(var fips in results)results[fips].candidateListOrdered=orderCandidateList(results[fips]),results[fips].details=Proto.lookup[fips];return results}(_.cloneDeep(resultsByCounty))}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/state",["require","jquery","lodash","config","helper","normalizations/presidential/state/generic","normalizations/presidential/state/house"],function(require,$,_,config,Helper){return function(data,opts,admin){data.raw;var raceId="house"===opts.feedData.raceId.toLowerCase()?"house":"generic",Model=new(require("normalizations/presidential/state/"+raceId))(data,opts,admin);for(var id in Model)Model.hasOwnProperty(id)&&(this[id]=Model[id])}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/state/generic",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,overrides){var totals,raw=_.isArray(data.raw)?data.raw[0]:data.raw,raceId=opts.feedData.raceId.toLowerCase(),winner=[],incumbent=[],resultsById={};this.totals=(totals=_.cloneDeep(raw.stateTotals),Helper.setPrecinctReporting(totals),totals),this.results=function(results){results=Helper.orderArrayByKey(results,"votes.count","desc"),results=Helper.setDisplayDetails(results);for(var info=[],i=0;i<results.length;i++){var item=results[i],npid=item.candidate.npid;("president"!==raceId||!!Helper.isPresidentialNPID(npid))&&(item.isWinner&&winner.push(npid),item.isIncumbent&&incumbent.push(npid),Helper.setPrecinctReporting(item),resultsById[npid]=item,info.push(item))}return info}(_.cloneDeep(raw.candidateResults)),this.isRunoff=function(items){for(var arr=[],i=0;i<items.length;i++)items[i].isWinner&&arr.push(items[i]);return 1<arr.length}(_.cloneDeep(raw.candidateResults)),this.resultsByCandidateId=resultsById,this.resultsByParty=Helper.resultsByParty(this.results),this.winner=winner,this.incumbent=incumbent}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/state/house",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,overrides){var raw=data.raw,winner={},incumbent={};function setDetails(id,results){for(var i=0;i<results.length;i++){var item=results[i];item.isWinner&&(winner[id]||(winner[id]=[]),winner[id].push(item)),item.isIncumbent&&(incumbent[id]||(incumbent[id]=[]),incumbent[id].push(item))}}function getRunoff(items){for(var arr=[],i=0;i<items.length;i++)items[i].isWinner&&arr.push(items[i]);return 1<arr.length}this.results=function(results){for(var info={},i=0;i<results.length;i++){var item=results[i],id=item.district.districtNumber;Helper.setPrecinctReporting(item),item.candidateResults=Helper.orderArrayByKey(item.candidateResults,"votes.count","desc"),item.candidateResults=Helper.setDisplayDetails(item.candidateResults),item.resultsByParty=Helper.resultsByParty(item.candidateResults),item.isRunoff=getRunoff(item.candidateResults),setDetails(id,item.candidateResults),info[id]=item}return info}(_.cloneDeep(raw)),this.winner=winner,this.incumbent=incumbent}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/presidential/summary",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){var raw=data.raw;function getWinners(items){for(var arr=[],i=0;i<items.length;i++)items[i].isWinner&&arr.push(items[i]);return 0<arr.length?arr:null}function orderResults(items){var winner=[],toOrder=[],info=null;if(function(items){for(var winner=!1,votes=!0,i=0;i<items.length;i++)items[i].isWinner&&(winner=!0),items[i].votes&&"number"==typeof items[i].votes.count&&0<items[i].votes.count&&(votes=!0);return{hasVotes:votes,hasWinner:winner}}(items).hasVotes){for(;0<items.length;){var item=items.shift();Helper.setDisplayDetails(item),item.isWinner?winner.push(item):toOrder.push(item)}0<winner.length&&1<winner.length&&(winner=Helper.orderArrayByKey(winner,"votes.count","desc")),toOrder=Helper.orderArrayByKey(toOrder,"votes.count","desc"),info=winner.concat(toOrder)}else{for(var i=0;i<items.length;i++)Helper.setDisplayDetails(items[i]);info=items}return info}function resultsByCandidateId(items){for(var info={},i=0;i<items.length;i++){var item=items[i];info[item.candidate.npid]=item}return info}this.results=function(results){for(var items,winners,info={},i=0;i<results.length;i++){var item=results[i],stateCode=item.stateCode;info[stateCode]||(info[stateCode]=[]),Helper.setPrecinctReporting(item),item.results=orderResults(item.results),item.resultsByParty=Helper.resultsByParty(item.results),item.resultsByCandidateId=resultsByCandidateId(item.results),item.stateAdminInfo=admin.views.stateInfo(stateCode),item.winner=getWinners(item.results),item.isRunoff=(items=item.results,void 0,winners=getWinners(items),!!(winners&&1<winners.length)),info[stateCode].push(item)}return info}(_.cloneDeep(raw))}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/primaries/admin",["require","jquery","lodash","config","helper","akamai"],function(require,$,_,config,Helper){return function(data){var raw=data.raw,CURRENT_TIME=Helper.getAkamaiTime();function setPollStatus(data){var open=data.open,close=data.close,status=null;if(open&&close)try{open=setPollDate(open),close=setPollDate(close),status=CURRENT_TIME<open?"pre":close<CURRENT_TIME?"post":"open"}catch(err){console.log(err)}return{open:open,close:close,status:status}}function setPollDate(val){var date=null;return Helper.isValidDate(val)?val:(val&&"string"==typeof val&&(date=Helper.setOverrideDate(val)),date)}this.states=function(states){var info={};for(var id in states){var item=states[id];for(var c in item.pollTimes=setPollStatus(item.pollTimes),item.primaries.pollTimes)item.primaries.pollTimes[c]=setPollStatus(item.primaries.pollTimes[c]);info[id]=item}return info}(raw.states),this.candidates=function(candidates){var info={};for(var npid in candidates){var item=candidates[npid];info[npid]=item}return info}(_.cloneDeep(raw.candidates))}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/primaries/national",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,overrides){var raw=data.raw;this.results=function(results){for(var info={},i=0;i<results.length;i++){var item=results[i],id=item.candidateNpid;info[id]=_.cloneDeep(item),delete info[id].candidateNpid}return info}(raw.results)}});
Modulr.define("fox-news.elections.feeds.2020:normalizations/primaries/state",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,opts,admin){if(data.raw){var raw=data.raw,dataType=opts.dataType,lookup=_.cloneDeep(raw.lookup);if(this.candidateLookup=function(list){if(!list)return null;for(var res={},i=0;i<list.length;i++){var item=list[i];res[item.npid]=item}return res}(raw.candidates||null),"counties"===dataType){var candidateLookup={};this.lookup=lookup,this.stateData=function(results){for(var info={},i=0;i<results.length;i++){var item=_.cloneDeep(results[i]),npid=item.candidate.npid;info[npid]=getCountyInfo(item.countyVotes),candidateLookup[npid]||(candidateLookup[npid]=item.candidate)}var obj={};return obj[opts.code]={results:info},obj}(raw.results),this.candidateLookup=candidateLookup}else this.stateData=function(stateData){for(var info={},i=0;i<stateData.length;i++){var item=_.cloneDeep(stateData[i]),fips=item.stateFips,code=item.stateCode;delete item.stateCode;for(var resultsObj={},n=0;n<item.results.length;n++){var candidate=item.results[n],npid=candidate.candidateNpid;resultsObj[npid]=candidate,delete resultsObj[npid].candidateNpid}resultsObj=setOverrides(fips,resultsObj),item.results=resultsObj,info[code]?(Array.isArray(info[code])||(info[code]=[_.cloneDeep(info[code])]),info[code].push(item)):info[code]=item}return info}(raw.stateResults)}else this.lookup={},this.stateData={};function getCountyInfo(counties){for(var info={},i=0;i<counties.length;i++){var item=counties[i],id=item.countyId,lookupData=lookup.counties[id];info[id]={countyInfo:lookupData,votes:item.votes}}return info}function setOverrides(fips,data){var info=admin.raw.state_overrides&&admin.raw.state_overrides[fips]||null;if(info){var npid,npidArr=[];for(npid in data)npidArr.push(npid);var found=!1;for(npid in info)if(-1<$.inArray(npid,npidArr)){found=!0;break}if(found)for(npid in data)data[npid].isWinner=!(!info[npid]||"yes"!==info[npid].winner);for(npid in data){var item=data[npid],oItem=info[npid]||null;oItem&&(item.votes&&(Helper.isNumeric(oItem.counts)&&item.votes.count&&(item.votes.count=parseInt(oItem.counts,10)),Helper.isNumeric(oItem.percentage)&&item.votes.percentage&&(item.votes.percentage=parseFloat(parseFloat(oItem.percentage).toFixed(1)))),Helper.isNumeric(oItem.delegates)&&item.delegates&&(item.delegates=parseInt(oItem.delegates,10)))}}return data}}});
Modulr.define("fox-news.elections.feeds.2020:router",["require","models/primaries/admin","models/primaries/national","models/primaries/state","models/presidential/admin","models/presidential/ratings","models/presidential/national","models/presidential/summary","models/presidential/state","models/presidential/state.county","models/presidential/bop","models/presidential/ballot.measures","models/presidential/electoral","models/presidential/dial.race.list","models/presidential/dial"],function(require){return function(type){var Proto=this;Proto.getAPI=function(conf){var National,State;return"primaries"===type?(National=require("models/primaries/national"),State=require("models/primaries/state"),{admin:require("models/primaries/admin"),national:National(conf),state:State(conf)}):function(){conf=conf||{};var Ratings=require("models/presidential/ratings"),National=require("models/presidential/national"),Summary=require("models/presidential/summary"),State=require("models/presidential/state"),County=require("models/presidential/state.county"),BOP=require("models/presidential/bop"),Ballot=require("models/presidential/ballot.measures"),Admin=require("models/presidential/admin"),Electoral=require("models/presidential/electoral"),DialRaceList=require("models/presidential/dial.race.list"),Dial=require("models/presidential/dial");return{admin:Admin,ratings:Ratings(conf),national:National(conf),summary:Summary(conf),state:State(conf),county:County(conf),bop:BOP(conf),ballot:Ballot(conf),electoral:Electoral(conf),dialRaceList:DialRaceList(conf),dial:Dial(conf)}}()},Proto.reload=function(id){Proto.getAPI().admin.reload(id)}}});
Modulr.define("fox-news.elections.feeds.2020:tests/init",["require","jquery","@FeedAPI"],function(require,$,FeedAPI){if($("body").hasClass("feed-test")){var cmd,Feed=FeedAPI.feed;cmd="loadData"==="load"?"getDataRefresh":"getData",console.log(Feed),Feed.National.getData(function(data){console.log(">>",data)}),Feed.Summary[cmd]("Governor",function(FeedInfo){console.log(FeedInfo.views.resultsByState())})}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/admin",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var Proto=this,norm=data.norm;Proto.electionMode=function(){return norm.electionMode||null},Proto.reloadMode=function(){return _.get(data,"raw.generalsettings.pageReload",null)},Proto.stateInfo=function(code){return code?data.raw.states[code]:data.raw.states},Proto.isPollClose=function(code){return data.raw.states[code]?"open"!==data.raw.states[code].pollTimes.status:null},Proto.isPollOpen=function(code){return!Proto.isPollClose(code)},Proto.isPollCloseAfter=function(code){if(!data.raw.states[code])return null;return"post"===data.raw.states[code].pollTimes.status},Proto.dialMode=function(type){return type?norm.dial[type]||null:norm.dial},Proto.winnerOverride=function(){var override=data.raw.generalsettings.winnerOverride;return!("none"===override||!override)&&override}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/ballot.measures",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var norm=data.norm;this.results=function(){return norm.results},this.resultsByState=function(code){return code?norm.resultsByState[code]:norm.resultsByState}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/bop",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var norm=data.norm;this.results=function(){return norm.results},this.resultByRace=function(raceId){return norm.results[raceId.toLowerCase()]||null}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/dial",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var norm=data.norm;this.results=function(){return norm.results},this.resultsPage=function(){return norm.resultsPage},this.resultsByRace=function(race){return norm.results[race]||null}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/dial.race.list",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var norm=data.norm;this.results=function(){return norm.results},this.racesByState=function(code){return code?norm.racesByState[code]||null:norm.racesByState}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/electoral",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var norm=data.norm;this.results=function(){return norm.results},this.resultByRace=function(raceId){return norm.results||null}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/national",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var Proto=this,norm=data.norm;Proto.electionMode=function(){return admin.views.electionMode()},Proto.resultsByVote=function(byPopular){return byPopular?norm.resultsByPopularVote:norm.resultsByElectoralVote},Proto.resultsByState=function(code){return code?norm.stateSummary[code]?norm.stateSummary[code]:null:norm.stateSummary},Proto.candidateById=function(id){return norm.results[id]||null},Proto.winner=function(){return norm.winner?Proto.candidateById(norm.winner[0]):null},Proto.electoralVotesInfo=function(){return norm.electoralVotesStatus},Proto.popularVotesInfo=function(){return norm.popularResultsByCandidateId}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/ratings",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(FEED_DATA,OPTS){var norm=FEED_DATA.norm,CHART_BY_ID={};function setEmptyArr(len){for(var arr=[],i=0;i<len;i++)arr.push(null);return arr}function setRatingArr(info,arrUID){for(var arr=[],i=0;i<arrUID.length;i++){var uid=arrUID[i];arr.push(info[uid]?getRating(info[uid]):null)}return arr}function getRating(info){return info[0]}this.items=function(type){return type=type||"rating",norm.ordered[type]||null},this.chartMulti=function(arrUID,type){type=type||"rating";var uid="multi-"+arrUID.join("_");if(CHART_BY_ID[uid])return CHART_BY_ID[uid];for(var data=_.cloneDeep(norm.ordered[type]),info={details:{},items:[],chart:[],ratingRows:[]},i=0;i<data.length;i++){var item=data[i],arr=[item.date];(arr=item[type]?(info.ratingRows.push(i),arr.concat(setRatingArr(item[type],arrUID))):arr.concat(setEmptyArr(arrUID.length))).push(item.event?0:null),"number"!=typeof info.details.max?info.details.max=arr[1]:arr[1]&&arr[1]>info.details.max&&(info.details.max=arr[1]),info.chart.push(arr),info.items.push(item)}return CHART_BY_ID[uid]=info},this.chartById=function(uid,type){if(type=type||"rating",CHART_BY_ID[uid])return CHART_BY_ID[uid];for(var data=_.cloneDeep(norm.ordered[type]),info={details:{},items:[],chart:[]},i=0;i<data.length;i++){var item=data[i],rating=item[type]?getRating(item[type][uid]):null;info.chart.push([item.date,rating,item.event?0:null]),rating&&("number"!=typeof info.details.max?info.details.max=rating:rating>info.details.max&&(info.details.max=rating)),info.items.push(item)}return CHART_BY_ID[uid]=info}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/state.county",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var norm=data.norm;this.results=function(){return norm.results},this.stateInfo=function(code){return admin.views.stateInfo(code)},this.candidateById=function(id){return norm.results[id]||null},this.resultsByCounty=function(fips,sort){var results=[];if(!isNaN(fips)){for(var npid in fips=parseInt(fips,10),norm.results){var item=norm.results[npid];item.countyVotesByFips[fips]&&results.push({candidate:item.candidate,votes:item.countyVotesByFips[fips].votes,votesDisplay:item.countyVotesByFips[fips].votesDisplay})}results="name"===sort?Helper.orderArrayByKey(results,"candidate.lastName","asc"):Helper.orderArrayByKey(results,"votes.count","desc")}var resultsById=function(){for(var obj={},i=0;i<results.length;i++){var item=results[i];obj[item.candidate.npid]=item}return obj}();return{results:results,resultsById:resultsById,details:norm.lookup[fips]}},this.resultsAllCounties=function(alphabetical){var info=[];if(alphabetical){var arr=[];for(var fips in norm.resultsByCounty)fips&&norm.resultsByCounty[fips].details&&arr.push(norm.resultsByCounty[fips]);info=arr=Helper.orderArrayByKey(arr,"details.name","asc")}else info=norm.resultsByCounty;return info},this.resultsForMapColor=function(){var info={},colors=config.PRESIDENTIAL.colors.candidate;for(var fips in norm.resultsByCounty){var item=norm.resultsByCounty[fips],val=null;if(1<item.lead.length)val=colors.tie;else if(1===item.lead.length){val=colors[item.lead[0].candidate.npid]||null}info[fips]=val}return info}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/state",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var Proto=this,norm=data.norm,raceId=feedOpts.feedData.raceId;Proto.stateInfo=function(code){return admin.views.stateInfo(code)},"House"===raceId?(Proto.results=function(){return norm.results},Proto.incumbent=function(){return norm.incumbent},Proto.winner=function(){return norm.winner}):(Proto.candidateById=function(id){return norm.resultsByCandidateId[id]||null},Proto.candidatesByParty=function(partyCode){return partyCode?norm.resultsByParty[partyCode]:norm.resultsByParty},Proto.results=function(){return norm.results},Proto.totals=function(){return norm.totals},Proto.incumbent=function(){if(!norm.incumbent)return null;for(var info=[],i=0;i<norm.incumbent.length;i++)info.push(Proto.candidateById(norm.incumbent[i]));return info},Proto.winner=function(){if(!norm.winner)return null;for(var info=[],i=0;i<norm.winner.length;i++)info.push(Proto.candidateById(norm.winner[i]));return info},Proto.isIncumbent=function(id){return-1<_.indexOf(norm.incumbent,id)},Proto.isWinner=function(id){return-1<_.indexOf(norm.winner,id)}),Proto.isRunoff=function(){return norm.isRunoff}}});
Modulr.define("fox-news.elections.feeds.2020:views/presidential/summary",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,admin){var norm=data.norm;this.resultsByState=function(code,district){var info=code?norm.results[code]?norm.results[code]:null:norm.results;if(info&&code&&void 0!==district&&!isNaN(district))for(var i=0;i<info.length;i++){var item=info[i];if(void 0===item.districtNumber)break;if(parseInt(item.districtNumber,10)===parseInt(district,10)){info=item;break}}return info}}});
Modulr.define("fox-news.elections.feeds.2020:views/primaries/admin",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts){var Proto=this,norm=data.norm;Proto.nationalDisplayTime=function(){return null},Proto.refreshMode=function(){return!0},Proto.electionMode=function(){var mode=data.raw.settings.electionMode;return"number"==typeof mode?[null,"pre","during","post"][mode]:"pre"},Proto.stateInfo=function(code){return code?norm.states[code]:norm.states},Proto.stateDataMode=function(code){return!0},Proto.isPollClose=function(code,party){if(!norm.states[code])return null;var state=norm.states[code];return"open"!==(party&&state.primaries[party]?state.primaries[party].status:state.pollTimes.status)},Proto.isPollOpen=function(code,party){return!Proto.isPollClose(code,party)},Proto.isPollCloseAfter=function(code,party){if(!norm.states[code])return null;var state=norm.states[code];return"post"===(party&&state.primaries[party]?state.primaries[party].status:state.pollTimes.status)}}});
Modulr.define("fox-news.elections.feeds.2020:views/primaries/national",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(data,feedOpts,adminData){var Proto=this;Proto.resultsByParty=function(id,orderInfo){var partyCandidates=Proto.candidatesByParty(id),info=[],sp="string"==typeof orderInfo?orderInfo.split(":"):[],order=sp[0]||"desc",orderBy=sp[1]||"delegates";for(var cid in partyCandidates)info.push(partyCandidates[cid]);if(order){var key="";switch(orderBy){case"alphabetical":key="candidateInfo.lastName";break;default:key="results.delegates"}info=Helper.orderArrayByKey(info,key,order)}return info},Proto.avaliableDelegates=function(){var info={};for(var id in data)info[id]=data[id].raw.availableDelegates;return info}}});
Modulr.define("fox-news.elections.feeds.2020:views/primaries/state",["require","jquery","lodash","config","helper"],function(require,$,_,config,Helper){return function(FEED_DATA,feedOpts,adminData){var Proto=this,dataType=feedOpts.dataType,stateCode=feedOpts.code||!1,candidates=function(raw){var res={};for(var id in raw)if(raw[id]){var info=raw[id].norm;info.candidateLookup&&_.merge(res,info.candidateLookup)}return res}(FEED_DATA);switch(Proto.stateResultsByParty=function(id,orderInfo){var party=FEED_DATA[id];if(!party)return null;party.raw;function set(code,state,orderInfo){return"counties"!==dataType?function(code,state,orderInfo){var listed={},sp="string"==typeof orderInfo?orderInfo.split(":"):[],order=sp[0]||"desc",orderBy=sp[1]||"votes";for(var cid in state.results){var item=state.results[cid],candidateInfo=getCandidateInfo(cid);if(candidateInfo){listed[cid]={details:item,isDroppedFromState:!1,candidateInfo:candidateInfo}}}if(order){var arr=[];for(var id in listed)listed[id].npid=id,arr.push(listed[id]);listed="alphabetical"===orderBy?Helper.orderArrayByKey(arr,"candidateInfo.lastName",order):candidateOrder(arr);for(var winners=[],i=0;i<listed.length;i++)listed[i].details.isWinner&&winners.push(listed.splice(i,1)[0]);winners&&(listed=winners.concat(listed))}var info={code:code};for(var key in state.results={orderBy:order||"desc",data:listed},state)"results"!==key&&(info[key]=state[key]);return{stateInfo:info,results:state.results}}(code,state,orderInfo):function(code,state,orderInfo){var ALL,listed={},sp="string"==typeof orderInfo?orderInfo.split(":"):[],order=sp[0]||!1,orderBy=sp[1]||"votes";for(var cid in state.results){var item=state.results[cid],candidateInfo=getCandidateInfo(cid);if(candidateInfo){listed[cid]={details:item,isDroppedFromState:!1,candidateInfo:candidateInfo}}}if(order)for(var id in listed){var arr=[];for(var did in listed[id].details){var details=listed[id].details[did];0===parseInt(did,10)?ALL=details:arr.push(details)}listed[id].details="alphabetical"===orderBy?Helper.orderArrayByKey(arr,"candidateInfo.lastName",order):candidateOrder(arr),listed[id].allCounties=ALL}var info={code:code};for(var key in state.results={orderBy:order||"unordered",data:listed},state)"results"!==key&&(info[key]=state[key]);return{stateInfo:info,results:state.results}}(code,state,orderInfo)}var norm=party.norm,info={},first=null;for(var code in norm.stateData){var state=_.cloneDeep(norm.stateData[code]);if(Array.isArray(state)){info[code]=[];for(var i=0;i<state.length;i++)info[code].push(set(code,state[i],orderInfo))}else info[code]=set(code,state,orderInfo);first=first||info[code]}return"all"!==dataType&&1===_.keys(info).length&&(info=first),_.isEmpty(info)&&(info=null),info},Proto.resultsByState=function(){var info={},rep=Proto.stateResultsByParty("R"),dem=Proto.stateResultsByParty("D");function setArr(party){for(var arr=[],i=0;i<party.length;i++){var item=party[i];arr.push({candidates:item.results.data,state:item.stateInfo})}return arr}function set(obj,pcode){for(var scode in obj){var item=obj[scode];if(info.data[scode]||(info.data[scode]={}),info.data[scode].results||(info.data[scode].results={}),Array.isArray(item))for(var i=0;i<item.length;i++){var aItem=item[i];info.data[scode].results[pcode]||(info.data[scode].results[pcode]=[]),info.data[scode].stateInfo||(info.data[scode].stateInfo={code:aItem.stateInfo.code,stateFips:aItem.stateInfo.stateFips}),info.data[scode].results[pcode].push({candidates:aItem.results.data,state:aItem.stateInfo})}else info.data[scode].stateInfo||(info.data[scode].stateInfo={code:item.stateInfo.code,stateFips:item.stateInfo.stateFips}),info.data[scode].results[pcode]={candidates:item.results.data,state:item.stateInfo}}}return"all"===dataType?(info={type:"all",data:{}},set(rep,"R"),set(dem,"D")):(rep||dem)&&(info[stateCode]={stateInfo:rep&&rep.stateInfo?rep.stateInfo:dem.stateInfo,results:{}},rep&&(Array.isArray(rep)?info[stateCode].results.R=setArr(rep):info[stateCode].results.R={candidates:rep.results.data,state:rep.stateInfo}),dem&&(Array.isArray(dem)?info[stateCode].results.D=setArr(dem):info[stateCode].results.D={candidates:dem.results.data,state:dem.stateInfo})),info},Proto.resultsByFipsCode=function(){var states=Proto.resultsByState(),data=states.data,info={data:{}};for(var i in states)"data"!==i&&(info[i]=states[i]);for(var scode in data){var item=data[scode],fips=item.stateInfo.stateFips;info.data[fips]=item}return info},Proto.pollTimes=function(){return overrides.views.pollTimesByState(stateCode)},Proto.getStateCode=function(){return stateCode},Proto.setPctPrecision=function(){return overrides.views.setPctPrecision()},Proto.dataAvailability=function(id){return fips=getStateInfo().stateFips,overrides.views.dataEnabledByState(fips,id)},Proto.getViewTypeForParty=function(id){return overrides.views.getViewTypeForParty(id,stateCode)},dataType){case"counties":Proto.resultsByCounty=function(id){var stateResults=Proto.stateResultsByParty(id);if(!stateResults)return null;var data=stateResults.results.data,info={};for(var cid in data){var candidateInfo=data[cid].candidateInfo;for(var countyId in data[cid].details){var item=data[cid].details[countyId],name=item.countyInfo.name;info[name]||(info[name]={countyInfo:_.cloneDeep(item.countyInfo),candidates:{}},delete info[name].countyInfo.name),info[name].candidates[cid]={candidateInfo:candidateInfo,votes:item.votes}}}return info},Proto.lookupCountyId=function(id){var lookup=FEED_DATA.R.norm.lookup.counties;return lookup[id]?lookup[id]:null},Proto.stateInfo=getStateInfo;break;case"code":Proto.winner=getWinners,Proto.pctReporting=function(id){var partyData=Proto.stateResultsByParty(id),use="WY"===stateCode?"precinctsReporting":"expectedPercentage";return partyData&&partyData.stateInfo&&"number"==typeof partyData.stateInfo[use]?partyData.stateInfo[use]:null},Proto.stateInfo=getStateInfo;break;case"all":Proto.winner=getWinners,Proto.winnerByState=function(){function set(party,code,val){obj[code]||(obj[code]={info:getStateInfo(code),results:{}}),obj[code].results[party]=val}var winners=getWinners(),obj={};for(var party in winners){var winner=winners[party];for(var code in winner)winner[code]&&set(party,code,winner[code])}return obj},Proto.infoByState=function(code){return getStateInfo(code)}}function getWinners(){var info={};for(var id in FEED_DATA){var norm=FEED_DATA[id].norm,first=null;for(var code in info[id]={},norm.stateData){var state=norm.stateData[code];for(var cid in info[id][code]=null,state.results)if(state.results[cid].isWinner){info[id][code]||(info[id][code]=[]);var winnerInfo=_.cloneDeep(state.results[cid]);winnerInfo.candidateInfo=candidates[cid],info[id][code].push(winnerInfo)}first=first||info[id][code]}info[id]=1===_.keys(info[id]).length?first:info[id],_.isEmpty(info[id])&&(info[id]=null)}return info}function getStateInfo(code){code=code||stateCode;var info=config.STATE_MAP[code],R=FEED_DATA.R.norm.stateData[code],D=FEED_DATA.D.norm.stateData[code];return info.stateFips=R&&R.stateFips?R.stateFips:D&&D.stateFips?D.stateFips:null,info}function getCandidateInfo(cid){return candidates[cid]||!1}function candidateOrder(rawOrder){var list=Helper.orderArrayByKey(rawOrder,"details.delegates","desc");return list=orderBy(list,"details.delegates","details.votes.count"),list=orderBy(list,"details.votes.count","candidateInfo.lastName",!0)}function orderBy(arr,sameAttr,orderAttr,alpha){for(var index=0;index<arr.length;){var item=arr[index]||null,nextItem=arr[index+1]||null,found=!1,sameLen=0;if(item&&nextItem)Helper.accessKeyVal(item,sameAttr)===Helper.accessKeyVal(nextItem,sameAttr)&&(sameLen=getSameLen(arr,index,sameAttr),found=!0);if(found){var replaceWith=Helper.orderArrayByKey(arr.slice(index,index+sameLen),orderAttr,alpha?"asc":"desc");arr=Helper.arrayReplace(index,sameLen,arr,replaceWith),index+=sameLen}else index++}return arr}function getSameLen(arr,index,sameAttr){for(var iter=0,stop=!1;!stop;){var item=arr[index+iter],nextItem=arr[index+(iter+1)]||null;if(item&&nextItem)Helper.accessKeyVal(item,sameAttr)===Helper.accessKeyVal(nextItem,sameAttr)?iter++:stop=!0;else stop=!0}return iter+1}}});
!function(Modulr,FNC){var uid="fox-news.elections.feeds.2020";if(Modulr.getInstance(uid))return;window.FOX_ENV_STATIC_DOMAIN;var Instance=Modulr.config({instance:uid,baseDomain:FNC.CDN.domain,baseUrl:"/static/orion/scripts/fox-news/elections/feeds/2020/app",masterFile:"/static/orion/scripts/core/utils/modulr/master.js",packages:["core.plugins","core.templates"],paths:{"@FeedAPI":"api.presidential"},shim:{jquery:{src:"/static/orion/scripts/core/utils/jquery/core.js",exports:"jQuery"},lodash:{src:"/static/orion/scripts/core/utils/lodash.js",exports:"_"},"jquery.numLiveUpdate":{src:"/static/orion/scripts/core/utils/jquery/plugins/numLiveUpdate.js",exports:"jQuery.fn.numLiveUpdate",deps:["jquery"]}}});Instance.define("cdn",function(){return FNC.CDN}),Instance.define("isa",function(){return FNC.ISA}),Instance.define("akamai",["core.base:utils/akamai"],function(Akamai){return Akamai}),Instance.define("ENV.PROD",["cdn"],function(CDN){return"prod"===CDN.env}),Instance.define("ENV",["cdn"],function(CDN){return CDN.env}),Instance.define("ENV_STATIC_DOMAIN",["cdn"],function(CDN){return CDN.domain}),Instance.define("SSL",[],function(){return-1<window.location.protocol.indexOf("https")||-1<window.location.host.indexOf("global.fncstatic.com")})}(window.Modulr,window.FNC);